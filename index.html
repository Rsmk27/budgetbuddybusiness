<!DOCTYPE html>
<html lang="en" class="light-mode">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Budget Buddy</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
        /* Custom styles and colors for the app */
        @layer base {
            :root {
                --primary: #2563eb; /* blue-600 */
                --secondary: #60a5fa; /* blue-400 */
                --positive: #16a34a; /* green-600 */
                --negative: #dc2626; /* red-600 */
                --warning: #facc15; /* yellow-400 */
                --bg-light: #f3f4f6; /* gray-100 */
                --bg-dark: #1f2937; /* gray-800 */
                --text-light: #1f2937; /* gray-800 */
                --text-dark: #f9fafb; /* gray-50 */
                --card-light: #ffffff;
                --card-dark: #374151; /* gray-700 */
                --border-light: #e5e7eb; /* gray-200 */
                --border-dark: #4b5563; /* gray-600 */
            }
            .light-mode {
                --bg-color: var(--bg-light);
                --text-color: var(--text-light);
                --card-color: var(--card-light);
                --border-color: var(--border-light);
            }
            .dark-mode {
                --bg-color: var(--bg-dark);
                --text-color: var(--text-dark);
                --card-color: var(--card-dark);
                --border-color: var(--border-dark);
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js and Datalabels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
</head>
<body class="bg-[--bg-color] text-[--text-color] font-[Inter] transition-colors duration-300">

    <!-- Main App Container -->
    <div class="flex flex-col md:flex-row min-h-screen">

        <!-- Sidebar Navigation -->
        <aside class="bg-[--card-color] p-6 shadow-lg md:w-64 flex-shrink-0 flex flex-col justify-between">
            <div>
                <div class="text-xl font-bold text-[--primary] mb-8" data-lang-key="appName">Business Budget Buddy</div>
                <nav>
                    <ul>
                        <li class="nav-item mb-2">
                            <a href="#dashboard" class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer" data-page="dashboard">
                                <i class="fas fa-tachometer-alt"></i>
                                <span data-lang-key="dashboard">Dashboard</span>
                            </a>
                        </li>
                        <li class="nav-item mb-2">
                            <a href="#income" class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer" data-page="income">
                                <i class="fas fa-hand-holding-usd"></i>
                                <span data-lang-key="income">Income</span>
                            </a>
                        </li>
                        <li class="nav-item mb-2">
                            <a href="#expenses" class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer" data-page="expenses">
                                <i class="fas fa-money-bill-wave"></i>
                                <span data-lang-key="expenses">Expenses</span>
                            </a>
                        </li>
                        <li class="nav-item mb-2">
                            <a href="#reports" class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer" data-page="reports">
                                <i class="fas fa-chart-pie"></i>
                                <span data-lang-key="reports">Reports</span>
                            </a>
                        </li>
                        <li class="nav-item mb-2">
                            <a href="#budgets" class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer" data-page="budgets">
                                <i class="fas fa-piggy-bank"></i>
                                <span data-lang-key="budgets">Budgets</span>
                            </a>
                        </li>
                        <li class="nav-item mb-2">
                            <a href="#settings" class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer" data-page="settings">
                                <i class="fas fa-cog"></i>
                                <span data-lang-key="settings">Settings</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
            
            <!-- Dark Mode and Language Switcher -->
            <div class="mt-8">
                <div class="flex items-center justify-between mb-4 p-2 rounded-lg bg-gray-100 dark:bg-gray-700">
                    <span data-lang-key="darkMode">Dark Mode</span>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" value="" class="sr-only peer" id="darkModeToggle">
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[--primary]"></div>
                    </label>
                </div>
                <div class="flex items-center justify-between p-2 rounded-lg bg-gray-100 dark:bg-gray-700">
                    <span data-lang-key="language">Language</span>
                    <select id="language-switcher" class="bg-transparent text-sm rounded-lg border-none focus:ring-0 focus:outline-none">
                        <option value="en">English</option>
                        <option value="hi">हिंदी</option>
                        <option value="te">తెలుగు</option>
                        <option value="ta">தமிழ்</option>
                        <option value="bn">বাংলা</option>
                    </select>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 p-6 transition-transform duration-300">
            <!-- All page sections will be loaded here -->
            <section id="dashboard" class="page active">
                <h2 class="text-3xl font-bold mb-6 text-[--primary]" data-lang-key="dashboardTitle">Dashboard Overview</h2>
                
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-[--card-color] p-6 rounded-lg shadow-md hover:scale-105 transition-transform" data-lang-key="revenueCard">
                        <h3 class="text-lg font-semibold text-gray-500 mb-2">Revenue</h3>
                        <p id="totalRevenue" class="text-3xl font-bold text-[--positive]">$0.00</p>
                    </div>
                    <div class="bg-[--card-color] p-6 rounded-lg shadow-md hover:scale-105 transition-transform" data-lang-key="expensesCard">
                        <h3 class="text-lg font-semibold text-gray-500 mb-2">Expenses</h3>
                        <p id="totalExpenses" class="text-3xl font-bold text-[--negative]">$0.00</p>
                    </div>
                    <div class="bg-[--card-color] p-6 rounded-lg shadow-md hover:scale-105 transition-transform" data-lang-key="profitCard">
                        <h3 class="text-lg font-semibold text-gray-500 mb-2">Profit / Loss</h3>
                        <p id="profitOrLoss" class="text-3xl font-bold">$0.00</p>
                    </div>
                    <div class="bg-[--card-color] p-6 rounded-lg shadow-md hover:scale-105 transition-transform" data-lang-key="cashFlowCard">
                        <h3 class="text-lg font-semibold text-gray-500 mb-2">Cash Flow</h3>
                        <p id="cashFlow" class="text-3xl font-bold">$0.00</p>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-[--card-color] p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold mb-4" data-lang-key="revenueGrowthChart">Revenue & Expenses Growth</h3>
                        <canvas id="revenueExpensesChart"></canvas>
                    </div>
                    <div class="bg-[--card-color] p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold mb-4" data-lang-key="expenseBreakdownChart">Expense Breakdown by Category</h3>
                        <canvas id="expensePieChart"></canvas>
                    </div>
                </div>
            </section>
            
            <section id="income" class="page hidden">
                <h2 class="text-3xl font-bold mb-6 text-[--primary]" data-lang-key="incomeTitle">Income Management</h2>
                <div class="bg-[--card-color] p-6 rounded-lg shadow-md">
                    <form id="income-form" class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <input type="text" id="incomeDescription" placeholder="Description" required class="p-3 rounded-lg border border-[--border-color] bg-transparent focus:outline-none focus:ring-2 focus:ring-[--primary]">
                        <input type="number" id="incomeAmount" placeholder="Amount" required class="p-3 rounded-lg border border-[--border-color] bg-transparent focus:outline-none focus:ring-2 focus:ring-[--primary]">
                        <select id="incomeCategory" class="p-3 rounded-lg border border-[--border-color] bg-transparent focus:outline-none focus:ring-2 focus:ring-[--primary]">
                            <option value="sales" data-lang-key="sales">Sales</option>
                            <option value="services" data-lang-key="services">Services</option>
                            <option value="investments" data-lang-key="investments">Investments</option>
                            <option value="funding" data-lang-key="funding">Funding</option>
                        </select>
                        <button type="submit" class="bg-[--positive] text-white p-3 rounded-lg font-semibold hover:bg-green-700 transition-colors" data-lang-key="addIncome">Add Income</button>
                    </form>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-[--card-color] rounded-lg">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-800 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                    <th class="py-3 px-4" data-lang-key="tableDate">Date</th>
                                    <th class="py-3 px-4" data-lang-key="tableDescription">Description</th>
                                    <th class="py-3 px-4" data-lang-key="tableCategory">Category</th>
                                    <th class="py-3 px-4" data-lang-key="tableAmount">Amount</th>
                                    <th class="py-3 px-4" data-lang-key="tableActions">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="income-table-body" class="divide-y divide-[--border-color]">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <section id="expenses" class="page hidden">
                <h2 class="text-3xl font-bold mb-6 text-[--primary]" data-lang-key="expensesTitle">Expense Tracking</h2>
                <div class="bg-[--card-color] p-6 rounded-lg shadow-md">
                    <form id="expense-form" class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <input type="text" id="expenseDescription" placeholder="Description" required class="p-3 rounded-lg border border-[--border-color] bg-transparent focus:outline-none focus:ring-2 focus:ring-[--primary]">
                        <input type="number" id="expenseAmount" placeholder="Amount" required class="p-3 rounded-lg border border-[--border-color] bg-transparent focus:outline-none focus:ring-2 focus:ring-[--primary]">
                        <select id="expenseCategory" class="p-3 rounded-lg border border-[--border-color] bg-transparent focus:outline-none focus:ring-2 focus:ring-[--primary]">
                            <option value="operations" data-lang-key="operations">Operations</option>
                            <option value="payroll" data-lang-key="payroll">Payroll</option>
                            <option value="marketing" data-lang-key="marketing">Marketing</option>
                            <option value="utilities" data-lang-key="utilities">Utilities</option>
                            <option value="materials" data-lang-key="materials">Raw Materials</option>
                            <option value="other" data-lang-key="other">Other</option>
                        </select>
                        <button type="submit" class="bg-[--negative] text-white p-3 rounded-lg font-semibold hover:bg-red-700 transition-colors" data-lang-key="addExpense">Add Expense</button>
                    </form>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-[--card-color] rounded-lg">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-800 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                    <th class="py-3 px-4" data-lang-key="tableDate">Date</th>
                                    <th class="py-3 px-4" data-lang-key="tableDescription">Description</th>
                                    <th class="py-3 px-4" data-lang-key="tableCategory">Category</th>
                                    <th class="py-3 px-4" data-lang-key="tableAmount">Amount</th>
                                    <th class="py-3 px-4" data-lang-key="tableActions">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="expense-table-body" class="divide-y divide-[--border-color]">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <section id="reports" class="page hidden">
                <h2 class="text-3xl font-bold mb-6 text-[--primary]" data-lang-key="reportsTitle">Reports & Analytics</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-[--card-color] p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold mb-4" data-lang-key="monthlyReport">Monthly Report</h3>
                        <canvas id="monthlyReportChart"></canvas>
                    </div>
                    <div class="bg-[--card-color] p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold mb-4" data-lang-key="quarterlyReport">Quarterly Report</h3>
                        <canvas id="quarterlyReportChart"></canvas>
                    </div>
                </div>
                <div class="bg-[--card-color] p-6 rounded-lg shadow-md flex justify-end">
                    <button id="exportCsvBtn" class="bg-[--primary] text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors" data-lang-key="exportCsv">Export as CSV</button>
                </div>
            </section>
            
            <section id="budgets" class="page hidden">
                <h2 class="text-3xl font-bold mb-6 text-[--primary]" data-lang-key="budgetsTitle">Budget Goals & Alerts</h2>
                <div class="bg-[--card-color] p-6 rounded-lg shadow-md">
                    <form id="budget-form" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <select id="budgetCategory" class="p-3 rounded-lg border border-[--border-color] bg-transparent focus:outline-none focus:ring-2 focus:ring-[--primary]">
                            <option value="operations" data-lang-key="operations">Operations</option>
                            <option value="payroll" data-lang-key="payroll">Payroll</option>
                            <option value="marketing" data-lang-key="marketing">Marketing</option>
                            <option value="utilities" data-lang-key="utilities">Utilities</option>
                            <option value="materials" data-lang-key="materials">Raw Materials</option>
                            <option value="other" data-lang-key="other">Other</option>
                        </select>
                        <input type="number" id="budgetAmount" placeholder="Budget Amount" required class="p-3 rounded-lg border border-[--border-color] bg-transparent focus:outline-none focus:ring-2 focus:ring-[--primary]">
                        <button type="submit" class="bg-[--primary] text-white p-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors" data-lang-key="setBudget">Set Budget</button>
                    </form>
                    <div id="budget-list" class="space-y-4">
                    </div>
                </div>
            </section>
            
            <section id="settings" class="page hidden">
                <h2 class="text-3xl font-bold mb-6 text-[--primary]" data-lang-key="settingsTitle">Data & Tips</h2>
                <div class="bg-[--card-color] p-6 rounded-lg shadow-md space-y-4">
                    <div class="flex flex-col md:flex-row md:space-x-4">
                        <button id="exportDataBtn" class="flex-1 bg-gray-500 text-white p-3 rounded-lg font-semibold hover:bg-gray-600 transition-colors" data-lang-key="exportData">Export Data (JSON)</button>
                        <button id="importDataBtn" class="flex-1 bg-gray-500 text-white p-3 rounded-lg font-semibold hover:bg-gray-600 transition-colors mt-2 md:mt-0" data-lang-key="importData">Import Data (JSON)</button>
                        <input type="file" id="importFile" class="hidden">
                    </div>
                    
                    <div class="p-4 rounded-lg bg-gray-100 dark:bg-gray-700">
                        <h3 class="text-lg font-semibold mb-2" data-lang-key="financialTips">Financial Tips</h3>
                        <p data-lang-key="tip1">
                            Regularly review your cash flow to identify trends and potential issues.
                        </p>
                        <p data-lang-key="tip2">
                            Separate your business and personal finances to maintain clear records.
                        </p>
                    </div>
                </div>
            </section>
            
            <!-- Custom Message Box -->
            <div id="message-box" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-2xl max-w-sm text-center">
                    <h3 id="message-title" class="text-xl font-bold mb-4"></h3>
                    <p id="message-body" class="mb-6"></p>
                    <button id="message-ok-btn" class="bg-[--primary] text-white px-6 py-2 rounded-lg font-semibold">OK</button>
                </div>
            </div>
            
        </main>
    </div>

    <script>
        // --- DATA AND STATE MANAGEMENT ---
        let appData = {
            expenses: [],
            income: [],
            budgets: {},
            settings: {
                language: 'en',
                darkMode: false,
                lastPage: 'dashboard'
            }
        };

        const translations = {
            en: {
                appName: "Business Budget Buddy",
                dashboard: "Dashboard",
                income: "Income",
                expenses: "Expenses",
                reports: "Reports",
                budgets: "Budgets",
                settings: "Settings",
                darkMode: "Dark Mode",
                language: "Language",
                dashboardTitle: "Dashboard Overview",
                revenueCard: "Revenue",
                expensesCard: "Expenses",
                profitCard: "Profit / Loss",
                cashFlowCard: "Cash Flow",
                revenueGrowthChart: "Revenue & Expenses Growth",
                expenseBreakdownChart: "Expense Breakdown by Category",
                incomeTitle: "Income Management",
                sales: "Sales",
                services: "Services",
                investments: "Investments",
                funding: "Funding",
                addIncome: "Add Income",
                expensesTitle: "Expense Tracking",
                operations: "Operations",
                payroll: "Payroll",
                marketing: "Marketing",
                utilities: "Utilities",
                materials: "Raw Materials",
                other: "Other",
                addExpense: "Add Expense",
                reportsTitle: "Reports & Analytics",
                monthlyReport: "Monthly Report",
                quarterlyReport: "Quarterly Report",
                exportCsv: "Export as CSV",
                budgetsTitle: "Budget Goals & Alerts",
                setBudget: "Set Budget",
                settingsTitle: "Data & Tips",
                exportData: "Export Data (JSON)",
                importData: "Import Data (JSON)",
                financialTips: "Financial Tips",
                tip1: "Regularly review your cash flow to identify trends and potential issues.",
                tip2: "Separate your business and personal finances to maintain clear records.",
                tableDate: "Date",
                tableDescription: "Description",
                tableCategory: "Category",
                tableAmount: "Amount",
                tableActions: "Actions",
                budgetAlertTitle: "Budget Alert!",
                budgetAlertMsg: (category, amount) => `You have spent $${amount.toFixed(2)} on ${category}, which exceeds your budget.`,
            },
            hi: {
                appName: "बिजनेस बजट बडी",
                dashboard: "डैशबोर्ड",
                income: "आमदनी",
                expenses: "खर्च",
                reports: "रिपोर्ट",
                budgets: "बजट",
                settings: "सेटिंग्स",
                darkMode: "डार्क मोड",
                language: "भाषा",
                dashboardTitle: "डैशबोर्ड अवलोकन",
                revenueCard: "राजस्व",
                expensesCard: "खर्च",
                profitCard: "लाभ / हानि",
                cashFlowCard: "नकद प्रवाह",
                revenueGrowthChart: "राजस्व और खर्च वृद्धि",
                expenseBreakdownChart: "श्रेणी के अनुसार खर्च का विवरण",
                incomeTitle: "आय प्रबंधन",
                sales: "बिक्री",
                services: "सेवाएं",
                investments: "निवेश",
                funding: "फंडिंग",
                addIncome: "आय जोड़ें",
                expensesTitle: "खर्च ट्रैकिंग",
                operations: "संचालन",
                payroll: "वेतन",
                marketing: "विपणन",
                utilities: "उपयोगिताएँ",
                materials: "कच्चा माल",
                other: "अन्य",
                addExpense: "खर्च जोड़ें",
                reportsTitle: "रिपोर्ट और विश्लेषण",
                monthlyReport: "मासिक रिपोर्ट",
                quarterlyReport: "तिमाही रिपोर्ट",
                exportCsv: "CSV के रूप में निर्यात करें",
                budgetsTitle: "बजट लक्ष्य और अलर्ट",
                setBudget: "बजट सेट करें",
                settingsTitle: "डेटा और টিপস",
                exportData: "डेटा निर्यात करें (JSON)",
                importData: "डेटा आयात करें (JSON)",
                financialTips: "वित्तीय सलाह",
                tip1: "प्रवृत्तियों और संभावित मुद्दों की पहचान करने के लिए नियमित रूप से अपने नकदी प्रवाह की समीक्षा करें।",
                tip2: "स्पष्ट रिकॉर्ड बनाए रखने के लिए अपने व्यवसाय और व्यक्तिगत वित्त को अलग करें।",
                tableDate: "दिनांक",
                tableDescription: "विवरण",
                tableCategory: "श्रेणी",
                tableAmount: "राशि",
                tableActions: "क्रियाएँ",
                budgetAlertTitle: "बजट अलर्ट!",
                budgetAlertMsg: (category, amount) => `आपने ${category} पर $${amount.toFixed(2)} खर्च किए हैं, जो आपके बजट से अधिक है।`,
            },
            te: {
                appName: "వ్యాపార బడ్జెట్ బడ్డీ",
                dashboard: "డాష్‌బోర్డ్",
                income: "ఆదాయం",
                expenses: "ఖర్చులు",
                reports: "నివేదికలు",
                budgets: "బడ్జెట్లు",
                settings: "సెట్టింగులు",
                darkMode: "డార్క్ మోడ్",
                language: "భాష",
                dashboardTitle: "డాష్‌బోర్డ్ అవలోకనం",
                revenueCard: "ఆదాయం",
                expensesCard: "ఖర్చులు",
                profitCard: "లాభం / నష్టం",
                cashFlowCard: "నగదు ప్రవాహం",
                revenueGrowthChart: "ఆదాయం మరియు ఖర్చుల వృద్ధి",
                expenseBreakdownChart: "కేటగిరీ వారీగా ఖర్చుల వివరాలు",
                incomeTitle: "ఆదాయ నిర్వహణ",
                sales: "అమ్మకాలు",
                services: "సేవలు",
                investments: "పెట్టుబడులు",
                funding: "నిధులు",
                addIncome: "ఆదాయం చేర్చు",
                expensesTitle: "ఖర్చుల ట్రాకింగ్",
                operations: "నిర్వహణ",
                payroll: "జీతం",
                marketing: "మార్కెటింగ్",
                utilities: "ఉపయోగాలు",
                materials: "ముడి పదార్థాలు",
                other: "ఇతర",
                addExpense: "ఖర్చు చేర్చు",
                reportsTitle: "నివేదికలు మరియు విశ్లేషణలు",
                monthlyReport: "నెలవారీ నివేదిక",
                quarterlyReport: "త్రైమాసిక నివేదిక",
                exportCsv: "CSVగా ఎగుమతి చేయి",
                budgetsTitle: "బడ్జెట్ లక్ష్యాలు మరియు హెచ్చరికలు",
                setBudget: "బడ్జెట్ సెట్ చేయండి",
                settingsTitle: "డేటా మరియు చిట్కాలు",
                exportData: "డేటా ఎగుమతి చేయండి (JSON)",
                importData: "డేటా దిగుమతి చేయండి (JSON)",
                financialTips: "ఆర్థిక చిట్కాలు",
                tip1: "ధోరణులను మరియు సంభావ్య సమస్యలను గుర్తించడానికి మీ నగదు ప్రవాహాన్ని క్రమం తప్పకుండా సమీక్షించండి.",
                tip2: "స్పష్టమైన రికార్డులను నిర్వహించడానికి మీ వ్యాపారం మరియు వ్యక్తిగత ఆర్థికాలను వేరు చేయండి.",
                tableDate: "తేదీ",
                tableDescription: "వివరణ",
                tableCategory: "కేటగిరీ",
                tableAmount: "మొత్తం",
                tableActions: "చర్యలు",
                budgetAlertTitle: "బడ్జెట్ హెచ్చరిక!",
                budgetAlertMsg: (category, amount) => `${category}పై మీరు $${amount.toFixed(2)} ఖర్చు చేశారు, ఇది మీ బడ్జెట్‌ను మించిపోయింది.`,
            },
            ta: {
                appName: "வணிக பட்ஜெட் நண்பர்",
                dashboard: "டாஷ்போர்டு",
                income: "வருமானம்",
                expenses: "செலவுகள்",
                reports: "அறிக்கைகள்",
                budgets: "பட்ஜெட்டுகள்",
                settings: "அமைப்புகள்",
                darkMode: "இருண்ட பயன்முறை",
                language: "மொழி",
                dashboardTitle: "டாஷ்போர்டு கண்ணோட்டம்",
                revenueCard: "வருவாய்",
                expensesCard: "செலவுகள்",
                profitCard: "லாபம் / நஷ்டம்",
                cashFlowCard: "பணப்புழக்கம்",
                revenueGrowthChart: "வருவாய் மற்றும் செலவுகள் வளர்ச்சி",
                expenseBreakdownChart: "பிரிவின்படி செலவுப் பகிர்வு",
                incomeTitle: "வருமான மேலாண்மை",
                sales: "விற்பனை",
                services: "சேவைகள்",
                investments: "முதலீடுகள்",
                funding: "நிதி",
                addIncome: "வருமானம் சேர்",
                expensesTitle: "செலவு கண்காணிப்பு",
                operations: "செயல்பாடுகள்",
                payroll: "ஊதியம்",
                marketing: "சந்தைப்படுத்துதல்",
                utilities: "பயன்பாடுகள்",
                materials: "கச்சா பொருட்கள்",
                other: "மற்றவை",
                addExpense: "செலவு சேர்",
                reportsTitle: "அறிக்கைகள் மற்றும் பகுப்பாய்வு",
                monthlyReport: "மாதாந்திர அறிக்கை",
                quarterlyReport: "காலாண்டு அறிக்கை",
                exportCsv: "CSV ஆக ஏற்றுமதி செய்",
                budgetsTitle: "பட்ஜெட் இலக்குகள் மற்றும் எச்சரிக்கைகள்",
                setBudget: "பட்ஜெட் அமை",
                settingsTitle: "தரவு மற்றும் குறிப்புகள்",
                exportData: "தரவை ஏற்றுமதி செய் (JSON)",
                importData: "தரவை இறக்குமதி செய் (JSON)",
                financialTips: "நிதி குறிப்புகள்",
                tip1: "போக்குகளையும் சாத்தியமான சிக்கல்களையும் கண்டறிய உங்கள் பணப்புழக்கத்தை தொடர்ந்து மதிப்பாய்வு செய்யுங்கள்.",
                tip2: "தெளிவான பதிவுகளைப் பராமரிக்க உங்கள் வணிக மற்றும் தனிப்பட்ட நிதிகளைப் பிரிக்கவும்.",
                tableDate: "தேதி",
                tableDescription: "விளக்கம்",
                tableCategory: "பிரிவு",
                tableAmount: "தொகை",
                tableActions: "நடவடிக்கைகள்",
                budgetAlertTitle: "பட்ஜெட் எச்சரிக்கை!",
                budgetAlertMsg: (category, amount) => `${category} மீது நீங்கள் $${amount.toFixed(2)} செலவழித்துள்ளீர்கள், இது உங்கள் பட்ஜெட்டை மீறுகிறது.`,
            },
            bn: {
                appName: "ব্যবসা বাজেট বন্ধু",
                dashboard: "ড্যাশবোর্ড",
                income: "আয়",
                expenses: "খরচ",
                reports: "রিপোর্ট",
                budgets: "বাজেট",
                settings: "সেটিংস",
                darkMode: "ডার্ক মোড",
                language: "ভাষা",
                dashboardTitle: "ড্যাশবোর্ড ওভারভিউ",
                revenueCard: "রাজস্ব",
                expensesCard: "খরচ",
                profitCard: "লাভ / ক্ষতি",
                cashFlowCard: "নগদ প্রবাহ",
                revenueGrowthChart: "রাজস্ব ও খরচের বৃদ্ধি",
                expenseBreakdownChart: "ক্যাটাগরি অনুযায়ী খরচের বিবরণ",
                incomeTitle: "আয় ব্যবস্থাপনা",
                sales: "বিক্রয়",
                services: "পরিষেবা",
                investments: "বিনিয়োগ",
                funding: "তহবিল",
                addIncome: "আয় যোগ করুন",
                expensesTitle: "খরচ ট্র্যাকিং",
                operations: "পরিচালনা",
                payroll: "বেতন",
                marketing: "মার্কেটিং",
                utilities: "ইউটিলিটি",
                materials: "কাঁচামাল",
                other: "অন্যান্য",
                addExpense: "খরচ যোগ করুন",
                reportsTitle: "রিপোর্ট এবং বিশ্লেষণ",
                monthlyReport: "মাসিক রিপোর্ট",
                quarterlyReport: "ত্রৈমাসিক রিপোর্ট",
                exportCsv: "CSV হিসাবে এক্সপোর্ট করুন",
                budgetsTitle: "বাজেট লক্ষ্য এবং সতর্কতা",
                setBudget: "বাজেট সেট করুন",
                settingsTitle: "ডেটা এবং টিপস",
                exportData: "ডেটা এক্সপোর্ট করুন (JSON)",
                importData: "ডেটা ইম্পোর্ট করুন (JSON)",
                financialTips: "আর্থিক টিপস",
                tip1: "প্রবণতা এবং সম্ভাব্য সমস্যাগুলি সনাক্ত করতে নিয়মিত আপনার নগদ প্রবাহ পর্যালোচনা করুন।",
                tip2: "পরিষ্কার রেকর্ড বজায় রাখার জন্য আপনার ব্যবসা এবং ব্যক্তিগত অর্থ আলাদা করুন।",
                tableDate: "তারিখ",
                tableDescription: "বিবরণ",
                tableCategory: "বিভাগ",
                tableAmount: "পরিমাণ",
                tableActions: "ক্রিয়াকলাপ",
                budgetAlertTitle: "বাজেট সতর্কতা!",
                budgetAlertMsg: (category, amount) => `${category} বাবদ আপনি $${amount.toFixed(2)} খরচ করেছেন, যা আপনার বাজেট অতিক্রম করেছে।`,
            },
        };
        
        // --- DOM ELEMENTS AND CONSTANTS ---
        const navItems = document.querySelectorAll('.nav-item a');
        const pages = document.querySelectorAll('.page');
        const dashboardSection = document.getElementById('dashboard');
        const incomeSection = document.getElementById('income');
        const expensesSection = document.getElementById('expenses');
        const reportsSection = document.getElementById('reports');
        const budgetsSection = document.getElementById('budgets');
        const settingsSection = document.getElementById('settings');
        const incomeForm = document.getElementById('income-form');
        const expenseForm = document.getElementById('expense-form');
        const budgetForm = document.getElementById('budget-form');
        const incomeTableBody = document.getElementById('income-table-body');
        const expenseTableBody = document.getElementById('expense-table-body');
        const budgetList = document.getElementById('budget-list');
        const languageSwitcher = document.getElementById('language-switcher');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const exportDataBtn = document.getElementById('exportDataBtn');
        const importDataBtn = document.getElementById('importDataBtn');
        const importFile = document.getElementById('importFile');
        const exportCsvBtn = document.getElementById('exportCsvBtn');

        let revenueExpensesChart = null;
        let expensePieChart = null;
        let monthlyReportChart = null;
        let quarterlyReportChart = null;
        
        // --- HELPER FUNCTIONS ---
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
        }
        
        function showMessage(title, message, isHtml = false) {
            const messageBox = document.getElementById('message-box');
            const messageTitle = document.getElementById('message-title');
            const messageBody = document.getElementById('message-body');
            const messageOkBtn = document.getElementById('message-ok-btn');
        
            messageTitle.textContent = title;
            if (isHtml) {
                messageBody.innerHTML = message;
            } else {
                messageBody.textContent = message;
            }
            messageBox.classList.remove('hidden');
        
            messageOkBtn.onclick = () => {
                messageBox.classList.add('hidden');
            };
        }

        // --- LOCAL STORAGE FUNCTIONS ---
        function saveData() {
            try {
                localStorage.setItem('budgetBuddyData', JSON.stringify(appData));
            } catch (e) {
                showMessage('Error', 'Could not save data to LocalStorage. It might be full.');
            }
        }

        function loadData() {
            try {
                const savedData = localStorage.getItem('budgetBuddyData');
                if (savedData) {
                    appData = JSON.parse(savedData);
                }
            } catch (e) {
                console.error("Failed to load data from LocalStorage:", e);
                // Clear corrupted data if needed
                // localStorage.removeItem('budgetBuddyData'); 
            }
        }

        // --- UI & RENDERING FUNCTIONS ---
        function switchPage(pageId) {
            pages.forEach(page => {
                if (page.id === pageId) {
                    page.classList.remove('hidden');
                    page.classList.add('active-page');
                } else {
                    page.classList.add('hidden');
                    page.classList.remove('active-page');
                }
            });

            navItems.forEach(item => {
                if (item.getAttribute('data-page') === pageId) {
                    item.classList.add('bg-gray-200', 'dark:bg-gray-700');
                } else {
                    item.classList.remove('bg-gray-200', 'dark:bg-gray-700');
                }
            });

            // Update state and save
            appData.settings.lastPage = pageId;
            saveData();

            // Re-render the charts for the new page
            if (pageId === 'dashboard') {
                renderDashboardCharts();
            } else if (pageId === 'reports') {
                renderReportsCharts();
            }
        }

        function applyLanguage(lang) {
            const currentTranslations = translations[lang] || translations['en'];
            document.querySelectorAll('[data-lang-key]').forEach(el => {
                const key = el.getAttribute('data-lang-key');
                if (currentTranslations[key]) {
                    if (el.tagName === 'INPUT' || el.tagName === 'BUTTON') {
                        el.setAttribute('placeholder', currentTranslations[key]);
                        el.setAttribute('value', currentTranslations[key]);
                    } else if (el.tagName === 'OPTION') {
                        el.textContent = currentTranslations[key];
                    } else {
                        el.textContent = currentTranslations[key];
                    }
                }
            });
            // Handle special cases like budget alert message
            appData.settings.language = lang;
            saveData();
        }

        function renderTransactions(type) {
            const tableBody = type === 'income' ? incomeTableBody : expenseTableBody;
            const transactions = appData[type];
            
            tableBody.innerHTML = ''; // Clear table
            transactions.forEach(t => {
                const row = document.createElement('tr');
                row.className = "hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors";
                row.innerHTML = `
                    <td class="py-2 px-4 whitespace-nowrap">${t.date}</td>
                    <td class="py-2 px-4 whitespace-nowrap">${t.description}</td>
                    <td class="py-2 px-4 whitespace-nowrap">${t.category}</td>
                    <td class="py-2 px-4 whitespace-nowrap">$${t.amount.toFixed(2)}</td>
                    <td class="py-2 px-4 text-right whitespace-nowrap">
                        <button onclick="deleteTransaction('${t.id}', '${type}')" class="text-red-500 hover:text-red-700 transition-colors">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function renderBudgets() {
            budgetList.innerHTML = '';
            const currentLang = appData.settings.language;
            const currentTranslations = translations[currentLang] || translations.en;

            for (const category in appData.budgets) {
                const amount = appData.budgets[category];
                const totalSpent = appData.expenses
                    .filter(exp => exp.category === category)
                    .reduce((sum, exp) => sum + exp.amount, 0);

                const progress = Math.min((totalSpent / amount) * 100, 100);
                const progressColor = progress > 90 ? 'bg-red-500' : 'bg-green-500';
                
                const card = document.createElement('div');
                card.className = "bg-[--card-color] p-4 rounded-lg shadow-sm";
                card.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-semibold capitalize">${currentTranslations[category] || category}</span>
                        <span class="text-sm text-gray-500 dark:text-gray-400">$${totalSpent.toFixed(2)} / $${amount.toFixed(2)}</span>
                        <button onclick="deleteBudget('${category}')" class="text-gray-400 hover:text-red-500 transition-colors">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                        <div class="h-2.5 rounded-full ${progressColor}" style="width: ${progress}%"></div>
                    </div>
                `;
                budgetList.appendChild(card);
            }
        }

        function updateDashboardMetrics() {
            const totalRevenue = appData.income.reduce((sum, t) => sum + t.amount, 0);
            const totalExpenses = appData.expenses.reduce((sum, t) => sum + t.amount, 0);
            const profitLoss = totalRevenue - totalExpenses;
            const cashFlow = totalRevenue - totalExpenses;
            
            document.getElementById('totalRevenue').textContent = `$${totalRevenue.toFixed(2)}`;
            document.getElementById('totalExpenses').textContent = `$${totalExpenses.toFixed(2)}`;
            
            const profitLossEl = document.getElementById('profitOrLoss');
            profitLossEl.textContent = `$${profitLoss.toFixed(2)}`;
            profitLossEl.className = profitLoss >= 0 ? 'text-3xl font-bold text-[--positive]' : 'text-3xl font-bold text-[--negative]';

            const cashFlowEl = document.getElementById('cashFlow');
            cashFlowEl.textContent = `$${cashFlow.toFixed(2)}`;
            cashFlowEl.className = cashFlow >= 0 ? 'text-3xl font-bold text-[--positive]' : 'text-3xl font-bold text-[--negative]';
        }

        function renderDashboardCharts() {
            // Destroy existing charts to prevent stacking
            if (revenueExpensesChart) revenueExpensesChart.destroy();
            if (expensePieChart) expensePieChart.destroy();

            // Revenue and Expenses over time
            const monthlyData = {};
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            appData.income.forEach(t => {
                const month = new Date(t.date).getMonth();
                if (!monthlyData[month]) monthlyData[month] = { income: 0, expenses: 0 };
                monthlyData[month].income += t.amount;
            });
            appData.expenses.forEach(t => {
                const month = new Date(t.date).getMonth();
                if (!monthlyData[month]) monthlyData[month] = { income: 0, expenses: 0 };
                monthlyData[month].expenses += t.amount;
            });

            const labels = Object.keys(monthlyData).sort((a,b) => a - b).map(m => months[m]);
            const revenueValues = Object.keys(monthlyData).sort((a,b) => a - b).map(m => monthlyData[m].income);
            const expenseValues = Object.keys(monthlyData).sort((a,b) => a - b).map(m => monthlyData[m].expenses);
            
            const revenueExpensesCtx = document.getElementById('revenueExpensesChart').getContext('2d');
            revenueExpensesChart = new Chart(revenueExpensesCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Revenue', data: revenueValues, borderColor: 'rgb(40, 167, 69)', fill: false },
                        { label: 'Expenses', data: expenseValues, borderColor: 'rgb(220, 53, 69)', fill: false }
                    ]
                }
            });

            // Expense Breakdown Pie Chart
            const expenseCategories = {};
            appData.expenses.forEach(exp => {
                expenseCategories[exp.category] = (expenseCategories[exp.category] || 0) + exp.amount;
            });

            const pieData = Object.values(expenseCategories);
            const pieLabels = Object.keys(expenseCategories).map(cat => translations[appData.settings.language][cat] || cat);

            const pieCtx = document.getElementById('expensePieChart').getContext('2d');
            expensePieChart = new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: pieLabels,
                    datasets: [{
                        data: pieData,
                        backgroundColor: [
                            'rgb(59, 130, 246)', 'rgb(239, 68, 68)', 'rgb(34, 197, 94)', 'rgb(245, 158, 11)', 'rgb(124, 58, 237)', 'rgb(75, 85, 99)'
                        ],
                        hoverOffset: 4
                    }]
                }
            });
        }

        function renderReportsCharts() {
            // Destroy existing charts
            if (monthlyReportChart) monthlyReportChart.destroy();
            if (quarterlyReportChart) quarterlyReportChart.destroy();
            
            // Monthly Report
            const monthlyData = {};
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const year = new Date().getFullYear();
            for (let i = 0; i < 12; i++) {
                monthlyData[months[i]] = { revenue: 0, expenses: 0 };
            }
            appData.income.forEach(t => {
                const date = new Date(t.date);
                if (date.getFullYear() === year) {
                    monthlyData[months[date.getMonth()]].revenue += t.amount;
                }
            });
            appData.expenses.forEach(t => {
                const date = new Date(t.date);
                if (date.getFullYear() === year) {
                    monthlyData[months[date.getMonth()]].expenses += t.amount;
                }
            });

            const monthlyLabels = Object.keys(monthlyData);
            const monthlyRevenue = monthlyLabels.map(m => monthlyData[m].revenue);
            const monthlyExpenses = monthlyLabels.map(m => monthlyData[m].expenses);
            
            const monthlyCtx = document.getElementById('monthlyReportChart').getContext('2d');
            monthlyReportChart = new Chart(monthlyCtx, {
                type: 'bar',
                data: {
                    labels: monthlyLabels,
                    datasets: [
                        { label: 'Revenue', data: monthlyRevenue, backgroundColor: 'rgba(40, 167, 69, 0.6)' },
                        { label: 'Expenses', data: monthlyExpenses, backgroundColor: 'rgba(220, 53, 69, 0.6)' }
                    ]
                }
            });

            // Quarterly Report
            const quarterlyData = { 'Q1': { revenue: 0, expenses: 0 }, 'Q2': { revenue: 0, expenses: 0 }, 'Q3': { revenue: 0, expenses: 0 }, 'Q4': { revenue: 0, expenses: 0 }};
            appData.income.forEach(t => {
                const month = new Date(t.date).getMonth();
                const quarter = `Q${Math.floor(month / 3) + 1}`;
                quarterlyData[quarter].revenue += t.amount;
            });
            appData.expenses.forEach(t => {
                const month = new Date(t.date).getMonth();
                const quarter = `Q${Math.floor(month / 3) + 1}`;
                quarterlyData[quarter].expenses += t.amount;
            });
            
            const quarterlyLabels = Object.keys(quarterlyData);
            const quarterlyRevenue = quarterlyLabels.map(q => quarterlyData[q].revenue);
            const quarterlyExpenses = quarterlyLabels.map(q => quarterlyData[q].expenses);

            const quarterlyCtx = document.getElementById('quarterlyReportChart').getContext('2d');
            quarterlyReportChart = new Chart(quarterlyCtx, {
                type: 'bar',
                data: {
                    labels: quarterlyLabels,
                    datasets: [
                        { label: 'Revenue', data: quarterlyRevenue, backgroundColor: 'rgba(40, 167, 69, 0.6)' },
                        { label: 'Expenses', data: quarterlyExpenses, backgroundColor: 'rgba(220, 53, 69, 0.6)' }
                    ]
                }
            });
        }
        
        // --- CRUD OPERATIONS ---
        function addTransaction(type, description, amount, category) {
            const transaction = {
                id: generateId(),
                date: new Date().toISOString().split('T')[0],
                description: description,
                amount: parseFloat(amount),
                category: category
            };
            appData[type].push(transaction);
            
            // Check budget for expenses
            if (type === 'expenses' && appData.budgets[category]) {
                const totalSpent = appData.expenses
                    .filter(exp => exp.category === category)
                    .reduce((sum, exp) => sum + exp.amount, 0);
                if (totalSpent > appData.budgets[category]) {
                    const currentLang = appData.settings.language;
                    const msg = translations[currentLang]?.budgetAlertMsg(translations[currentLang]?.[category] || category, totalSpent);
                    showMessage(translations[currentLang]?.budgetAlertTitle, msg);
                }
            }

            saveData();
            updateDashboardMetrics();
            renderTransactions(type);
            if (type === 'expenses') {
                renderBudgets();
            }
        }

        function deleteTransaction(id, type) {
            appData[type] = appData[type].filter(t => t.id !== id);
            saveData();
            updateDashboardMetrics();
            renderTransactions(type);
            if (type === 'expenses') {
                renderBudgets();
            }
        }
        
        function addBudget(category, amount) {
            appData.budgets[category] = parseFloat(amount);
            saveData();
            renderBudgets();
        }

        function deleteBudget(category) {
            delete appData.budgets[category];
            saveData();
            renderBudgets();
        }

        // --- DATA IMPORT/EXPORT ---
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'budget_buddy_data.json';
            link.click();
            URL.revokeObjectURL(url);
        }
        
        function importData(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedData = JSON.parse(e.target.result);
                    // Simple validation
                    if (importedData.expenses && importedData.income) {
                        appData = importedData;
                        saveData();
                        location.reload(); // Reload to apply changes
                    } else {
                        showMessage('Import Error', 'Invalid data format. Please select a valid Budget Buddy JSON file.');
                    }
                } catch (e) {
                    showMessage('Import Error', 'Could not parse the JSON file.');
                }
            };
            reader.readAsText(file);
        }
        
        function exportCsv() {
            const allTransactions = [...appData.income.map(t => ({...t, type: 'Income'})), ...appData.expenses.map(t => ({...t, type: 'Expense'}))];
            
            if (allTransactions.length === 0) {
                showMessage('Export Error', 'No data to export.');
                return;
            }

            const header = ["Date", "Description", "Category", "Amount", "Type"];
            const csvRows = [header.join(',')];
            
            allTransactions.forEach(t => {
                const row = [t.date, t.description, t.category, t.amount, t.type].map(item => `"${item}"`).join(',');
                csvRows.push(row);
            });

            const csvString = csvRows.join('\n');
            const blob = new Blob([csvString], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'business_budget_report.csv';
            link.click();
            URL.revokeObjectURL(url);
        }

        // --- EVENT LISTENERS ---
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            applyLanguage(appData.settings.language);
            languageSwitcher.value = appData.settings.language;
            
            document.body.classList.toggle('dark-mode', appData.settings.darkMode);
            darkModeToggle.checked = appData.settings.darkMode;

            renderTransactions('income');
            renderTransactions('expenses');
            renderBudgets();
            updateDashboardMetrics();
            
            switchPage(appData.settings.lastPage);
        });

        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const pageId = item.getAttribute('data-page');
                switchPage(pageId);
            });
        });

        incomeForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addTransaction('income', incomeForm.incomeDescription.value, incomeForm.incomeAmount.value, incomeForm.incomeCategory.value);
            incomeForm.reset();
        });

        expenseForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addTransaction('expenses', expenseForm.expenseDescription.value, expenseForm.expenseAmount.value, expenseForm.expenseCategory.value);
            expenseForm.reset();
        });

        budgetForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addBudget(budgetForm.budgetCategory.value, budgetForm.budgetAmount.value);
            budgetForm.reset();
        });

        languageSwitcher.addEventListener('change', (e) => {
            applyLanguage(e.target.value);
        });

        darkModeToggle.addEventListener('change', () => {
            document.body.classList.toggle('dark-mode');
            appData.settings.darkMode = darkModeToggle.checked;
            saveData();
        });

        exportDataBtn.addEventListener('click', exportData);
        
        importDataBtn.addEventListener('click', () => {
            importFile.click();
        });
        
        importFile.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                importData(file);
            }
        });
        
        exportCsvBtn.addEventListener('click', exportCsv);
    </script>

</body>
</html>
